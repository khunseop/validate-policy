# Flask 웹 애플리케이션 사용 가이드

## 개요

방화벽 정책 검증 시스템을 Flask 웹 애플리케이션으로 실행할 수 있습니다.
로컬 웹 브라우저에서 파일을 업로드하고 검증 결과를 확인할 수 있습니다.

## 중요 제약사항

⚠️ **DRM 파일 처리 제약사항:**
- `xlwings`는 서버에 **Excel이 설치되어 있어야** DRM 보호 파일을 처리할 수 있습니다.
- **Windows/Mac**: 가능 (Excel 설치 필요)
- **Linux 서버**: 불가능 (Excel이 없음)
- **로컬 실행**: 권장 (로컬에서 Flask 앱 실행)

## 설치 및 실행

### 1. 패키지 설치

```bash
pip install -r requirements.txt
```

### 2. 웹 애플리케이션 실행

```bash
python app.py
```

### 3. 브라우저에서 접속

```
http://127.0.0.1:5000
```

## 사용 방법

1. **파일 업로드**
   - Running 정책 파일 (필수)
   - Candidate 정책 파일 (필수)
   - 대상 정책 파일 (여러 개 선택 가능, 선택사항)

2. **검증 시작**
   - "검증 시작" 버튼 클릭
   - 파일 파싱 및 검증 진행

3. **결과 확인**
   - 검증 결과 요약 확인
   - 리포트 다운로드

## 파일 구조

```
validate-policy/
├── app.py                    # Flask 웹 애플리케이션
├── parse_firewall_policy.py  # 정책 파싱 및 검증 로직
├── templates/
│   └── index.html           # 웹 인터페이스
├── static/                   # 정적 파일 (CSS, JS)
└── requirements.txt          # 필요한 패키지
```

## 기능

- ✅ 파일 업로드 (드래그 앤 드롭 지원)
- ✅ 여러 대상 정책 파일 선택
- ✅ 실시간 검증 진행 상황 표시
- ✅ 검증 결과 요약 표시
- ✅ 리포트 다운로드 (날짜 포함 파일명)

## 주의사항

1. **Excel 설치 필요**: 서버에 Excel이 설치되어 있어야 DRM 파일 처리 가능
2. **로컬 실행 권장**: 원격 서버보다 로컬에서 실행하는 것이 안정적
3. **파일 크기 제한**: 최대 100MB까지 업로드 가능
4. **임시 파일**: 업로드된 파일은 임시 디렉터리에 저장되며, 세션 종료 시 자동 삭제

## 문제 해결

### Excel이 설치되어 있지 않은 경우
- Windows/Mac에 Excel을 설치하거나
- 로컬에서 Flask 앱을 실행하세요

### 파일 업로드 오류
- 파일 크기가 100MB를 초과하지 않는지 확인
- Excel 파일 형식(.xlsx, .xls)인지 확인

### DRM 파일을 읽을 수 없는 경우
- Excel이 정상적으로 설치되어 있는지 확인
- Excel이 다른 프로세스에서 사용 중이 아닌지 확인
